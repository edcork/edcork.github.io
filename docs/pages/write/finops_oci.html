---
title: Integrate with Azure for CMP FinOps
sidebar: writing_sidebar
toc: false
permalink: finops_azure.html
folder: write
---

<p>Before you can use the Cloud Management Platform (CMP) FinOps solution, you must set up integrations with the cloud platforms from which you want to pull cloud data. We support integrations with Amazon Web Services (AWS), Azure, Google Cloud Platform (GCP), and Oracle Cloud Infrastructure (OCI).</p>

<p>The CMP FinOps solution currently supports only the collection of cloud billing data from OCI (integrations with AWS, Azure, and GCP also support the collection of cloud account and cloud recommendations data).</p>

<p>This topic describes how to&nbsp;set up a Cloud Cost Data Provider-based integration to retrieve cloud billing data from OCI. This will give you access to&nbsp;CMP FinOps' cloud cost visualization and optimization functionalities, including cost governance reports&nbsp;and cloud cost limits.</p>

<h2>Complete prerequisite tasks in OCI</h2>

<p>OCI generates Cost and Usage (CUR) reports, which contain the cloud billing data that CMP FinOps uses,&nbsp;by default. You can't modify these reports. Therefore, you don't have to set up or configure CUR reports to set up an integration with OCI. However, you do have to perform some initial setup to access the reports.</p>

<h3>Create a user and generate a secret key</h3>

<p>OCI does not have service accounts. In order to grant CMP FinOps API access to the OCI cloud data, you must create a real user- no service users in OCI, so create a real user and use &quot;customer secret key&quot; to grant API access to CMP FinOps.</p>

<ol>
	<li>Log in to OCI Console as a member of the Administrators group.</li>
	<li>In the navigation menu, click <strong>Identity &amp; Security</strong> &gt; <strong>Domains</strong>, and then select the identity domain that you want to work in. You might need to change the compartment to find the domain that you want.</li>
	<li>Click&nbsp;<strong>Users</strong>&nbsp;&gt;&nbsp;<strong>Create user.</strong></li>
	<li>In the&nbsp;<strong>First name</strong>&nbsp;and&nbsp;<strong>Last name</strong>&nbsp;fields enter the user's name. For example, you name this user &quot;FinOps Admin&quot;.</li>
	<li>Leave the&nbsp;<strong>Use the email address as the username</strong>&nbsp;option selected.</li>
	<li>In the&nbsp;<strong>Username / Email</strong>&nbsp;field, enter an email address for the user account, and then click&nbsp;<strong>Create</strong>.</li>
	<li>In the left-hand <strong>Resources</strong> menu, click <strong>Customer secret keys</strong>, and then click <strong>Generate secret key</strong>.</li>
	<li>Enter a name for the key, and then click&nbsp;<strong>Generate secret key</strong>.</li>
	<li>Make a note of the values in the <strong>Name</strong> and <strong>Access key</strong> columns.&nbsp;You will need these values when configuring the Cloud Cost Data Provider-based integration.</li>
</ol>

<h3>Set up and configure a group</h3>

<ol>
	<li>In the navigation menu, click <strong>Identity &amp; Security</strong> &gt; <strong>Domains</strong>, and then select the identity domain that you want to work in. You might need to change the compartment to find the domain that you want.</li>
	<li>Click&nbsp;<strong>Groups</strong>&nbsp;&gt;&nbsp;<strong>Create group</strong>.</li>
	<li>In the&nbsp;<strong>Name</strong>&nbsp;and&nbsp;<strong>Description</strong>&nbsp;fields of the&nbsp;<strong>Create group</strong>&nbsp;window, enter the name of the group (for example, &quot;oci_finops&quot;) and a description.</li>
	<li>Add the user that you created earlier to the group.</li>
	<li>Click&nbsp;<strong>Create</strong>.</li>
</ol>

<h3>Create a policy</h3>

<ol>
	<li>In the navigation menu, click <strong>Identity &amp; Security</strong> &gt; <strong>Identity&nbsp;</strong>&gt;&nbsp;<strong>Create Policy</strong>.</li>
	<li>In the&nbsp;<strong>Name</strong>&nbsp;and&nbsp;<strong>Description</strong>&nbsp;fields of the&nbsp;<strong>Create policy</strong>&nbsp;window, enter the name of the policy (for example, &quot;oci_cur_reports&quot;) and a description.</li>
	<li>If you want to attach the policy to a compartment other than the one you're viewing, select it from the <strong>Compartment</strong> list.&nbsp;</li>
	<li>Click&nbsp;<strong>Show manual editor</strong>, and then copy the following text to the <strong>Policy Builder</strong> text box.
	<pre>
<code>define tenancy usage-report as ocid1.tenancy.oc1..aaaaaaaaned4fkpkisbwjlr56u7cj63lf3wffbilvqknstgtvzub7vhqkggq
endorse group &lt;group&gt; to read objects in tenancy usage-report</code></pre>
	Update the <code>&lt;group&gt;</code> placeholder in this text with the name of the group that you created earlier. For example, &quot;oci_finops&quot;.</li>
	<li>Click&nbsp;<strong>Create</strong>.</li>
</ol>

<h2>Set up a Cloud Cost Data Provider-based integration&nbsp;</h2>

<p>This integration enables you to retrieve historical and current cloud billing data for expenditures associated with your cloud provider. This information will be available within the reporting interface.</p>

<ol>
	<li>Log in to&nbsp;Agent Interface as the cloud integration administrator.</li>
	<li>Go to <b>Administration </b>&gt;<b> Providers </b>&gt;<b> Cloud Cost Data Providers.</b></li>
	<li>On the <strong>Integrations</strong> page, click <strong>Add Integration</strong>&nbsp;(if no integrations exist) or the <img alt="hcm 2018 11 integrations add.png" data-file-height="20" data-file-width="22" height="20" src="/mediawiki/images/7/7a/hcm_2018_11_integrations_add.png" width="22" /> icon on the right pane (to add an additional integration).</li>
	<li>Select <strong>Oracle Cloud Infrastructure</strong>, click <b>NEXT</b>, and then enter the following information:
	<table cellpadding="1" cellspacing="1" style="width: 500px;">
		<thead>
			<tr>
				<th scope="col">Field</th>
				<th scope="col">Description</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><b>Connection Name</b></td>
				<td>Identifier for the OCI integration, for example, &quot;My OCI&quot;.</td>
			</tr>
			<tr>
				<td><b>Access Key ID</b></td>
				<td>The name of the customer secret key that you created in OCI Console earlier.</td>
			</tr>
			<tr>
				<td><b>Secret Access Key</b></td>
				<td>The access key of the customer secret key that you created in OCI Console earlier.</td>
			</tr>
			<tr>
				<td><b>Billing Bucket Name</b></td>
				<td>
				<p>The Oracle Cloud ID (OCID) of your root compartment.<br />
				<br />
				To see the OCID of all your compartments (including the root compartment), log in to OCI Console as a member of the Administrators group, and then click <strong>Identity &amp; Security</strong> &gt; <strong>Compartments</strong>&nbsp;in the navigation menu.</p>
				</td>
			</tr>
			<tr>
				<td><b>Billing Report Path</b></td>
				<td>Enter <code>reports/cost-csv</code>.</td>
			</tr>
			<tr>
				<td><strong>Bucket Endpoint URL</strong></td>
				<td>
				<p>Enter <code>https://bling.compat.objectstorage.&lt;OCI region&gt;.oraclecloud.com</code>.<br />
				&nbsp;</p>

				<p>Replace the <code>&lt;OCI region&gt; </code>placeholder with your OCI home region. For example, you enter&nbsp;<code>https://bling.compat.objectstorage.us-ashburn1.oraclecloud.com</code>.<br />
				<br />
				For information about OCI home regions, see <a href="https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managingregions.htm#The" title="Managing Regions">Managing Regions</a>.</p>
				</td>
			</tr>
		</tbody>
	</table>
	</li>
	<li>Select the <b>I require a proxy server to connect to this provider</b>&nbsp;option&nbsp;if you want to use a proxy server to connect to the cloud provider. You can use either the system default proxy server (configured by a suite administrator) or a custom proxy server.</li>
	<li>Select the&nbsp;<strong>I require a custom base URL to connect to this provider</strong>&nbsp;option if you don't want to contact the cloud provider at its default endpoint.</li>
	<li>Click <strong>NEXT</strong>, and then specify&nbsp;the following information:
	<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
		<thead>
			<tr>
				<th scope="col">Field</th>
				<th scope="col">Description</th>
			</tr>
			<tr>
				<td><strong>Collection History Cutoff</strong></td>
				<td>By default, all available cloud billing data is fetched from the cloud provider. <span style="background-color:#e74c3c;">For Azure, Microsoft preserves three years of history (dated from present day).</span> If you wish to limit the amount of data, select a&nbsp;collection start date so that your collection only gathers data from the specified date. For example, selecting January 2020 will fetch data from that point to the present day and into the future. There is no end date.</td>
			</tr>
			<tr>
				<td><strong>Cloud Tags</strong></td>
				<td>To enable cloud tags for the selected provider, specify the name and key. Cloud tags help you to filter, search, and manage the OCI resources.&nbsp;For more information, see <a href="/doc/SMAX/Main/CloudTags" title="Configure cloud tags">Configure Cloud Tags</a>.</td>
			</tr>
		</thead>
	</table>
	</li>
	<li>Click <b>FINISH</b>.</li>
</ol>

<h2>Related topics</h2>

<ul>
	<li>For more information about cost and usage reports&nbsp;in OCI, see&nbsp;<a href="https://docs.oracle.com/en-us/iaas/Content/Billing/Concepts/costusagereportsoverview.htm" title="Cost and Usage Reports">Cost and Usage Reports</a>.</li>
	<li>For more information about users in OCI, see&nbsp;<a href="https://docs.oracle.com/en-us/iaas/Content/Identity/users/about-managing-users.htm" title="Managing Users">Managing Users</a>.</li>
	<li>For more information about groups in OCI, see <a href="https://docs.oracle.com/en-us/iaas/Content/Identity/groups/managinggroups.htm" title="Managing Groups">Managing Groups</a>.</li>
	<li>For more information about policies in OCI, see <a href="https://docs.oracle.com/en-us/iaas/Content/Identity/policymgmt/managingpolicies_topic-tasks.htm" title="Managing Policies">Managing Policies</a>.</li>
	<li>For information about cloud tags, see <a href="/doc/SMAX/Main/CloudTags" title="Configure cloud tags">Configure cloud tags</a>.</li>
</ul>